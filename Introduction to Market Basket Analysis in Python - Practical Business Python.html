<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Introduction to Market Basket Analysis in&nbsp;Python - Practical Business Python</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Using mlxtend to perform market basket analysis on online retail data set.">
    <meta name="author" content="Chris Moffitt">
    <meta name="generator" content="Pelican (VoidyBootstrap theme)">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Introduction to Market Basket Analysis in&nbsp;Python">
    <meta name="twitter:description" content="Using mlxtend to perform market basket analysis on online retail data set.">
    <meta name="twitter:site" content="@chris1610">
    <meta name="twitter:creator" content="@chris1610">
    <meta name="twitter:domain" content="https://pbpython.com">
    <meta property="twitter:image" content="https://pbpython.com/images/market-basket.png">

        <link rel="stylesheet" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/bootstrap.css">
        <link href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/css_002.css" rel="stylesheet" type="text/css">
        <link href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/css.css" rel="stylesheet" type="text/css">
      <link rel="stylesheet" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/font-awesome.css">


      <link rel="stylesheet" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/friendly.css">
      <link rel="stylesheet" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/voidybootstrap.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="https://pbpython.com/favicon.ico">

        <link href="https://pbpython.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Practical Business Python Atom Feed">
<script async="" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/async-ads.js"></script><script type="text/javascript" async="" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/cse.js"></script><script async="" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/analytics.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55110683-1', '');
  ga('send', 'pageview');

</script>
  <script type="text/javascript" async="" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/embed.js"></script><script async="" type="text/javascript" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/count.js"></script><script src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/cse_element__en.js" type="text/javascript"></script><link type="text/css" rel="stylesheet" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/defaulten.css"><link type="text/css" rel="stylesheet" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/default.css"><style type="text/css">.gsc-control-cse{font-family:arial, sans-serif}.gsc-control-cse .gsc-table-result{font-family:arial, sans-serif}.gsc-control-cse{border-color:#FFFFFF;background-color:#FFFFFF}input.gsc-input,.gsc-input-box,.gsc-input-box-hover,.gsc-input-box-focus{border-color:#D9D9D9}.gsc-search-button-v2,.gsc-search-button-v2:hover,.gsc-search-button-v2:focus{border-color:#666666;background-color:#999999;background-image:none;filter:none}.gsc-search-button-v2 svg{fill:#FFFFFF}.gsc-tabHeader.gsc-tabhInactive{border-color:#CCCCCC;background-color:#FFFFFF}.gsc-tabHeader.gsc-tabhActive{border-color:#CCCCCC;border-bottom-color:#FFFFFF;background-color:#FFFFFF}.gsc-tabsArea{border-color:#CCCCCC}.gsc-webResult.gsc-result,.gsc-results .gsc-imageResult{border-color:#FFFFFF;background-color:#FFFFFF}.gsc-webResult.gsc-result:hover,.gsc-imageResult:hover{border-color:#FFFFFF;background-color:#FFFFFF}.gs-webResult.gs-result a.gs-title:link,.gs-webResult.gs-result a.gs-title:link b,.gs-imageResult a.gs-title:link,.gs-imageResult a.gs-title:link b{color:#0000CC}.gs-webResult.gs-result a.gs-title:visited,.gs-webResult.gs-result a.gs-title:visited b,.gs-imageResult a.gs-title:visited,.gs-imageResult a.gs-title:visited b{color:#0000CC}.gs-webResult.gs-result a.gs-title:hover,.gs-webResult.gs-result a.gs-title:hover b,.gs-imageResult a.gs-title:hover,.gs-imageResult a.gs-title:hover b{color:#0000CC}.gs-webResult.gs-result a.gs-title:active,.gs-webResult.gs-result a.gs-title:active b,.gs-imageResult a.gs-title:active,.gs-imageResult a.gs-title:active b{color:#0000CC}.gsc-cursor-page{color:#0000CC}a.gsc-trailing-more-results:link{color:#0000CC}.gs-webResult .gs-snippet,.gs-imageResult .gs-snippet,.gs-fileFormatType{color:#000000}.gs-webResult div.gs-visibleUrl,.gs-imageResult div.gs-visibleUrl{color:#008000}.gs-webResult div.gs-visibleUrl-short{color:#008000}.gs-webResult div.gs-visibleUrl-short{display:none}.gs-webResult div.gs-visibleUrl-long{display:block}.gs-promotion div.gs-visibleUrl-short{display:none}.gs-promotion div.gs-visibleUrl-long{display:block}.gsc-cursor-box{border-color:#FFFFFF}.gsc-results .gsc-cursor-box .gsc-cursor-page{border-color:#CCCCCC;background-color:#FFFFFF;color:#0000CC;}.gsc-results .gsc-cursor-box .gsc-cursor-current-page{border-color:#CCCCCC;background-color:#FFFFFF;color:#0000CC;}.gsc-webResult.gsc-result.gsc-promotion{border-color:#336699;background-color:#FFFFFF}.gsc-completion-title{color:#0000CC}.gsc-completion-snippet{color:#000000}.gs-promotion a.gs-title:link,.gs-promotion a.gs-title:link *,.gs-promotion .gs-snippet a:link{color:#0000CC}.gs-promotion a.gs-title:visited,.gs-promotion a.gs-title:visited *,.gs-promotion .gs-snippet a:visited{color:#0000CC}.gs-promotion a.gs-title:hover,.gs-promotion a.gs-title:hover *,.gs-promotion .gs-snippet a:hover{color:#0000CC}.gs-promotion a.gs-title:active,.gs-promotion a.gs-title:active *,.gs-promotion .gs-snippet a:active{color:#0000CC}.gs-promotion .gs-snippet,.gs-promotion .gs-title .gs-promotion-title-right,.gs-promotion .gs-title .gs-promotion-title-right *{color:#000000}.gs-promotion .gs-visibleUrl,.gs-promotion .gs-visibleUrl-short{color:#008000}.gcsc-find-more-on-google{color:#0000CC}.gcsc-find-more-on-google-magnifier{fill:#0000CC}</style><style type="text/css">.gscb_a{display:inline-block;font:27px/13px arial,sans-serif}.gsst_a .gscb_a{color:#a1b9ed;cursor:pointer}.gsst_a:hover .gscb_a,.gsst_a:focus .gscb_a{color:#36c}.gsst_a{display:inline-block}.gsst_a{cursor:pointer;padding:0 4px}.gsst_a:hover{text-decoration:none!important}.gsst_b{font-size:16px;padding:0 2px;position:relative;user-select:none;-moz-user-select:none;white-space:nowrap}.gsst_e{vertical-align:middle;opacity:0.55;}.gsst_a:hover .gsst_e,.gsst_a:focus .gsst_e{opacity:0.72;}.gsst_a:active .gsst_e{opacity:1;}.gsst_f{background:white;text-align:left}.gsst_g{background-color:white;border:1px solid #ccc;border-top-color:#d9d9d9;box-shadow:0 2px 4px rgba(0,0,0,0.2);-moz-box-shadow:0 2px 4px rgba(0,0,0,0.2);margin:-1px -3px;padding:0 6px}.gsst_h{background-color:white;height:1px;margin-bottom:-1px;position:relative;top:-1px}.gsib_a{width:100%;padding:4px 6px 0}.gsib_a,.gsib_b{vertical-align:top}.gssb_c{border:0;position:absolute;z-index:989}.gssb_e{border:1px solid #ccc;border-top-color:#d9d9d9;box-shadow:0 2px 4px rgba(0,0,0,0.2);-moz-box-shadow:0 2px 4px rgba(0,0,0,0.2);cursor:default}.gssb_f{visibility:hidden;white-space:nowrap}.gssb_k{border:0;display:block;position:absolute;top:0;z-index:988}.gsdd_a{border:none!important}.gsq_a{padding:0}.gsq_a{padding:0}.gssb_a{padding:0 7px}.gssb_a,.gssb_a td{white-space:nowrap;overflow:hidden;line-height:22px}#gssb_b{font-size:11px;color:#36c;text-decoration:none}#gssb_b:hover{font-size:11px;color:#36c;text-decoration:underline}.gssb_g{text-align:center;padding:8px 0 7px;position:relative}.gssb_h{font-size:15px;height:28px;margin:0.2em}.gssb_i{background:#eee}.gss_ifl{visibility:hidden;padding-left:5px}.gssb_i .gss_ifl{visibility:visible}a.gssb_j{font-size:13px;color:#36c;text-decoration:none;line-height:100%}a.gssb_j:hover{text-decoration:underline}.gssb_l{height:1px;background-color:#e5e5e5}.gssb_m{color:#000;background:#fff}.gssb_a{padding:0 9px}.gsib_a{padding-right:8px;padding-left:8px}.gsst_a{padding-top:5.5px}.gssb_e{border:0}.gssb_l{margin:5px 0}input.gsc-input::-webkit-input-placeholder{font-size:14px}input.gsc-input:-moz-placeholder{font-size:14px}input.gsc-input::-moz-placeholder{font-size:14px}input.gsc-input:-ms-input-placeholder{font-size:14px}input.gsc-input:focus::-webkit-input-placeholder{color:transparent}input.gsc-input:focus:-moz-placeholder{color:transparent}input.gsc-input:focus::-moz-placeholder{color:transparent}input.gsc-input:focus:-ms-input-placeholder{color:transparent}.gssb_c .gsc-completion-container{position:static}.gssb_c{z-index:5000}.gsc-completion-container table{background:transparent;font-size:inherit;font-family:inherit}.gssb_c > tbody > tr,.gssb_c > tbody > tr > td,.gssb_d,.gssb_d > tbody > tr,.gssb_d > tbody > tr > td,.gssb_e,.gssb_e > tbody > tr,.gssb_e > tbody > tr > td{padding:0;margin:0;border:0}.gssb_a table,.gssb_a table tr,.gssb_a table tr td{padding:0;margin:0;border:0}</style><link rel="prefetch" as="style" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/a_data/lounge.css"><link rel="prefetch" as="script" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/a_data/common.js"><link rel="prefetch" as="script" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/a_data/lounge_002.js"><link rel="prefetch" as="script" href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/a_data/config.js"></head>

  <body>
    <div class="navbar navbar-default" role="navigation">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="https://pbpython.com/" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
          <!-- <li> <a href="https://pbpython.com/">Home</a> </li> -->
            <li><a href="https://pbpython.com/">Home</a></li>
            <li><a href="https://pbpython.com/pages/about-site.html">About</a></li>
            <li><a href="https://pbpython.com/pages/resources.html">Resources</a></li>
            <li><a href="https://pbpython.com/pages/mailinglist.html">Mailing List</a></li>
            <li class="divider"></li>
            <li class="">
              <a href="https://pbpython.com/archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="https://pbpython.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </div> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="https://pbpython.com/">Practical Business Python</a></h1>
		<p class="lead">Taking care of business, one python script at a time</p>
	  </div>
	</div>

    <div class="container">
      <div class="row">
        <div class="col-md-9" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Mon 03 July 2017
</abbr> <h1>
  <a href="https://pbpython.com/market-basket-analysis.html" rel="bookmark" title="Permalink to Introduction to Market Basket Analysis in&nbsp;Python">
    Introduction to Market Basket Analysis in&nbsp;Python
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="https://pbpython.com/author/chris-moffitt.html">Chris Moffitt</a>
    in 
    <a href="https://pbpython.com/category/articles.html">
      articles</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
      <img class="article-image img-responsive" alt="article header image" itemprop="image" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/market-basket.png">
	<div class="section" id="introduction">
<h2>Introduction</h2>
<p>There are many data analysis tools available to the python analyst and it can be
challenging to know which ones to use in a particular situation. A useful
(but somewhat overlooked) technique is called association analysis
which attempts to find common patterns of items in large data sets. One specific
application is often called market basket analysis.  The most
commonly cited example of market basket analysis is the so-called “beer and diapers”
case. The basic story is that a large retailer
was able to mine their transaction data and find an unexpected purchase pattern
of individuals that were buying beer and baby diapers at the same&nbsp;time.</p>
<p>Unfortunately this story is most likely a <a class="reference external" href="http://www.dssresources.com/newsletters/66.php">data urban legend</a>. However, it is
an illustrative (and entertaining) example of the types of insights
that can be gained by mining transactional&nbsp;data.</p>
<p>While these types of associations are normally used for looking at sales transactions;
the basic analysis can be applied to other situations like click stream tracking,
spare parts ordering and online recommendation engines - just to name a&nbsp;few.</p>
<p>If you have some basic understanding of the python data science world, your first
inclination would be to look at scikit-learn for a ready-made algorithm. However,
scikit-learn does not support this algorithm. Fortunately, the very useful <a class="reference external" href="http://rasbt.github.io/mlxtend/">MLxtend</a>
library by Sebastian Raschka has a a an implementation of the <a class="reference external" href="http://rasbt.github.io/mlxtend/user_guide/frequent_patterns/apriori/">Apriori algorithm</a>
for extracting frequent item sets for further&nbsp;analysis.</p>
<p>The rest of this article will walk through an example of using this library
to analyze a relatively large <a class="reference external" href="http://archive.ics.uci.edu/ml/datasets/Online+Retail">online retail</a> data set and try to find
interesting purchase combinations. By the end of this article, you should be
familiar enough with the basic approach to apply it to your own data&nbsp;sets.</p>
</div>
<div class="section" id="why-association-analysis">
<h2>Why Association&nbsp;Analysis?</h2>
<p>In today’s world, there are many complex ways to analyze data (clustering, regression,
Neural Networks, Random Forests, <span class="caps">SVM</span>, etc.). The challenge with many of these approaches
is that they can be difficult to tune, challenging to interpret and require quite a bit
of data prep and feature engineering to get  good results. In other words, they
can be very powerful but require a lot of knowledge to implement&nbsp;properly.</p>
<p>Association analysis is relatively light on the math concepts and easy to explain
to non-technical people. In addition, it is an unsupervised learning tool that looks
for hidden patterns so there is limited need for data prep and feature engineering.
It is a good start for certain cases of data exploration and can point the way for a deeper dive
into the data using other&nbsp;approaches.</p>
<p>As an added bonus, the python implementation in MLxtend should be very familiar
to anyone that has exposure to scikit-learn and pandas. For all these reasons,
I think it is a useful tool to be familiar with and can help you with
your data analysis&nbsp;problems.</p>
<p>One quick note - technically, market basket analysis is just one application of
association analysis. In this post though, I will use association
analysis and market basket analysis&nbsp;interchangeably.</p>
</div>
<div class="section" id="association-analysis-101">
<h2>Association Analysis&nbsp;101</h2>
<p>There are a couple of terms used in association analysis that are important to understand.
This <a class="reference external" href="http://www-users.cs.umn.edu/~kumar/dmbook/ch6.pdf">chapter</a> in <a class="reference external" href="http://www-users.cs.umn.edu/~kumar/dmbook/index.php">Introduction to Data Mining</a> is a great reference for those
interested in the math behind these definitions and the details of the algorithm&nbsp;implementation.</p>
<p>Association rules are normally written like this: {Diapers} -&gt; {Beer} which means that
there is a strong relationship between customers that purchased diapers and also purchased
beer in the same&nbsp;transaction.</p>
<p>In the above example, the {Diaper} is the <strong>antecedent</strong> and the {Beer} is the <strong>consequent</strong>.
Both antecedents and consequents can have multiple items. In other words,
{Diaper, Gum} -&gt; {Beer, Chips} is a valid&nbsp;rule.</p>
<p><strong>Support</strong> is the relative frequency that the rules show up. In many instances, you
may want to look for high support in order to make sure it is a useful relationship.
However, there may be instances where a low support is useful if you are trying to find
“hidden”&nbsp;relationships.</p>
<p><strong>Confidence</strong> is a measure of the reliability of the rule. A confidence of .5 in
the above example would mean that in 50% of the cases where Diaper and Gum were
purchased, the purchase also included Beer and Chips. For product
recommendation, a 50% confidence may be perfectly acceptable but in a medical
situation, this level may not be high&nbsp;enough.</p>
<p><strong>Lift</strong> is the ratio of the observed support to that expected if the two rules were
independent (see <a class="reference external" href="https://en.wikipedia.org/wiki/Association_rule_learning">wikipedia</a>). The basic rule of thumb is that a lift value close
to 1 means the rules were completely independent. Lift values &gt; 1 are generally
more “interesting” and could be indicative of a useful rule&nbsp;pattern.</p>
<p>One final note, related to the data. This analysis requires that all the data for
a transaction be included in 1 row and the items should be 1-hot encoded.
The MLxtend <a class="reference external" href="http://rasbt.github.io/mlxtend/user_guide/frequent_patterns/apriori/">documentation</a> example is&nbsp;useful:</p>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table class="table table-condensed" border="1">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Apple</th>
<th>Corn</th>
<th>Dill</th>
<th>Eggs</th>
<th>Ice cream</th>
<th>Kidney Beans</th>
<th>Milk</th>
<th>Nutmeg</th>
<th>Onion</th>
<th>Unicorn</th>
<th>Yogurt</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div><p>The specific <a class="reference external" href="http://archive.ics.uci.edu/ml/datasets/Online+Retail">data</a> for this article comes from the <span class="caps">UCI</span> Machine Learning Repository
and represents transactional data from a <span class="caps">UK</span> retailer from 2010-2011. This mostly
represents sales to wholesalers so it is slightly different from consumer purchase
patterns but is still a useful case&nbsp;study.</p>
</div>
<div class="section" id="let-s-code">
<h2>Let’s&nbsp;Code</h2>
<p>MLxtend can be installed using pip, so make sure that is done before trying to
execute any of the code below. Once it is installed, the code below shows how
to get it up and running. I have made the <a class="reference external" href="https://github.com/chris1610/pbpython/blob/master/notebooks/Market_Basket_Intro.ipynb">notebook</a> available so feel free to
follow along with the examples&nbsp;below.</p>
<p>Get our pandas and MLxtend code imported and read the&nbsp;data:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">mlxtend.frequent_patterns</span> <span class="kn">import</span> <span class="n">apriori</span>
<span class="kn">from</span> <span class="nn">mlxtend.frequent_patterns</span> <span class="kn">import</span> <span class="n">association_rules</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">'http://archive.ics.uci.edu/ml/machine-learning-databases/00352/Online%20Retail.xlsx'</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table class="table table-condensed" border="1">
<thead>
<tr style="text-align: right;">
<th></th>
<th>InvoiceNo</th>
<th>StockCode</th>
<th>Description</th>
<th>Quantity</th>
<th>InvoiceDate</th>
<th>UnitPrice</th>
<th>CustomerID</th>
<th>Country</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>536365</td>
<td>85123A</td>
<td><span class="caps">WHITE</span> <span class="caps">HANGING</span> <span class="caps">HEART</span> T-<span class="caps">LIGHT</span> <span class="caps">HOLDER</span></td>
<td>6</td>
<td>2010-12-01 08:26:00</td>
<td>2.55</td>
<td>17850.0</td>
<td>United Kingdom</td>
</tr>
<tr>
<th>1</th>
<td>536365</td>
<td>71053</td>
<td><span class="caps">WHITE</span> <span class="caps">METAL</span> <span class="caps">LANTERN</span></td>
<td>6</td>
<td>2010-12-01 08:26:00</td>
<td>3.39</td>
<td>17850.0</td>
<td>United Kingdom</td>
</tr>
<tr>
<th>2</th>
<td>536365</td>
<td>84406B</td>
<td><span class="caps">CREAM</span> <span class="caps">CUPID</span> <span class="caps">HEARTS</span> <span class="caps">COAT</span> <span class="caps">HANGER</span></td>
<td>8</td>
<td>2010-12-01 08:26:00</td>
<td>2.75</td>
<td>17850.0</td>
<td>United Kingdom</td>
</tr>
<tr>
<th>3</th>
<td>536365</td>
<td>84029G</td>
<td><span class="caps">KNITTED</span> <span class="caps">UNION</span> <span class="caps">FLAG</span> <span class="caps">HOT</span> <span class="caps">WATER</span> <span class="caps">BOTTLE</span></td>
<td>6</td>
<td>2010-12-01 08:26:00</td>
<td>3.39</td>
<td>17850.0</td>
<td>United Kingdom</td>
</tr>
<tr>
<th>4</th>
<td>536365</td>
<td>84029E</td>
<td><span class="caps">RED</span> <span class="caps">WOOLLY</span> <span class="caps">HOTTIE</span> <span class="caps">WHITE</span> <span class="caps">HEART</span>.</td>
<td>6</td>
<td>2010-12-01 08:26:00</td>
<td>3.39</td>
<td>17850.0</td>
<td>United Kingdom</td>
</tr>
</tbody>
</table>
</div><p>There is a little cleanup, we need to do. First, some of the descriptions have spaces
that need to be removed. We’ll also drop the rows that don’t have invoice numbers
and remove the credit transactions (those with invoice numbers containing&nbsp;C).</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">'Description'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Description'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">'InvoiceNo'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">'InvoiceNo'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'InvoiceNo'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'str'</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">'InvoiceNo'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">'C'</span><span class="p">)]</span>
</pre></div>
<p>After the cleanup, we need to consolidate the items into 1 transaction per row with each
product <a class="reference external" href="https://pbpython.com/categorical-encoding.html">1 hot encoded</a>. For the sake of keeping the data set small, I’m only
looking at sales for France. However, in additional code below, I will compare
these results to sales from Germany. Further country comparisons would be
interesting to&nbsp;investigate.</p>
<div class="highlight"><pre><span></span><span class="n">basket</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">]</span> <span class="o">==</span><span class="s2">"France"</span><span class="p">]</span>
          <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'InvoiceNo'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">])[</span><span class="s1">'Quantity'</span><span class="p">]</span>
          <span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
          <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'InvoiceNo'</span><span class="p">))</span>
</pre></div>
<p>Here’s what the first few columns look like (note, I added some numbers
to the columns to illustrate the concept - the actual data in this example
is all&nbsp;0’s):</p>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table class="table table-condensed" border="1">
<thead>
<tr style="text-align: right;">
<th>Description</th>
<th>10 <span class="caps">COLOUR</span> <span class="caps">SPACEBOY</span> <span class="caps">PEN</span></th>
<th>12 <span class="caps">COLOURED</span> <span class="caps">PARTY</span> <span class="caps">BALLOONS</span></th>
<th>12 <span class="caps">EGG</span> <span class="caps">HOUSE</span> <span class="caps">PAINTED</span> <span class="caps">WOOD</span></th>
<th>12 <span class="caps">MESSAGE</span> <span class="caps">CARDS</span> <span class="caps">WITH</span> <span class="caps">ENVELOPES</span></th>
<th>12 <span class="caps">PENCIL</span> <span class="caps">SMALL</span> <span class="caps">TUBE</span> <span class="caps">WOODLAND</span></th>
<th>12 <span class="caps">PENCILS</span> <span class="caps">SMALL</span> <span class="caps">TUBE</span> <span class="caps">RED</span> <span class="caps">RETROSPOT</span></th>
<th>12 <span class="caps">PENCILS</span> <span class="caps">SMALL</span> <span class="caps">TUBE</span> <span class="caps">SKULL</span></th>
<th>12 <span class="caps">PENCILS</span> <span class="caps">TALL</span> <span class="caps">TUBE</span> <span class="caps">POSY</span></th>
</tr>
<tr>
<th>InvoiceNo</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>536370</th>
<td>11.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr>
<th>536852</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>5.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>536974</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>537065</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>7.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>537463</th>
<td>0.0</td>
<td>0.0</td>
<td>9.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div><p>There are a lot of zeros in the data but we also need to make sure any positive
values are converted to a 1 and anything less the 0 is set to 0. This step will
complete the one hot encoding of the data and remove the postage column (since
that charge is not one we wish to&nbsp;explore):</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encode_units</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

<span class="n">basket_sets</span> <span class="o">=</span> <span class="n">basket</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">encode_units</span><span class="p">)</span>
<span class="n">basket_sets</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'POSTAGE'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
<p>Now that the data is structured properly, we can generate frequent item sets
that have a support of at least 7% (this number was chosen so that I could
get enough useful&nbsp;examples):</p>
<div class="highlight"><pre><span></span><span class="n">frequent_itemsets</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">basket_sets</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p>The final step is to generate the rules with their corresponding support, confidence and&nbsp;lift:</p>
<div class="highlight"><pre><span></span><span class="n">rules</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"lift"</span><span class="p">,</span> <span class="n">min_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rules</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table class="table table-condensed" border="1">
<thead>
<tr style="text-align: right;">
<th></th>
<th>antecedants</th>
<th>consequents</th>
<th>support</th>
<th>confidence</th>
<th>lift</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">WOODLAND</span> <span class="caps">ANIMALS</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">CIRCUS</span> <span class="caps">PARADE</span>)</td>
<td>0.170918</td>
<td>0.597015</td>
<td>3.545907</td>
</tr>
<tr>
<th>1</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">CIRCUS</span> <span class="caps">PARADE</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">WOODLAND</span> <span class="caps">ANIMALS</span>)</td>
<td>0.168367</td>
<td>0.606061</td>
<td>3.545907</td>
</tr>
<tr>
<th>2</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">CIRCUS</span> <span class="caps">PARADE</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">SPACEBOY</span>)</td>
<td>0.168367</td>
<td>0.530303</td>
<td>3.849607</td>
</tr>
<tr>
<th>3</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">SPACEBOY</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">CIRCUS</span> <span class="caps">PARADE</span>)</td>
<td>0.137755</td>
<td>0.648148</td>
<td>3.849607</td>
</tr>
<tr>
<th>4</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">WOODLAND</span> <span class="caps">ANIMALS</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">SPACEBOY</span>)</td>
<td>0.170918</td>
<td>0.611940</td>
<td>4.442233</td>
</tr>
</tbody>
</table>
</div><p>That’s all there is to it! Build the frequent items using <code class="code">
apriori</code>
 then
build the rules with <code class="code">
association_rules</code>
.</p>
<p>Now, the tricky part is figuring out what this tells us.
For instance, we can see that there are quite a few rules with a high lift value
which means that it occurs more frequently than would be expected given the number
of transaction and product combinations. We can also see several where the confidence
is high as well. This part of the analysis is where the domain knowledge
will come in handy. Since I do not have that, I’ll just look for a couple of
illustrative&nbsp;examples.</p>
<p>We can filter the dataframe using standard pandas code. In this case, look for a
large lift (6) and high confidence&nbsp;(.8):</p>
<div class="highlight"><pre><span></span><span class="n">rules</span><span class="p">[</span> <span class="p">(</span><span class="n">rules</span><span class="p">[</span><span class="s1">'lift'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span>
       <span class="p">(</span><span class="n">rules</span><span class="p">[</span><span class="s1">'confidence'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table class="table table-condensed" border="1">
<thead>
<tr style="text-align: right;">
<th></th>
<th>antecedants</th>
<th>consequents</th>
<th>support</th>
<th>confidence</th>
<th>lift</th>
</tr>
</thead>
<tbody>
<tr>
<th>8</th>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">CUPS</span>)</td>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">PLATES</span>)</td>
<td>0.137755</td>
<td>0.888889</td>
<td>6.968889</td>
</tr>
<tr>
<th>9</th>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">PLATES</span>)</td>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">CUPS</span>)</td>
<td>0.127551</td>
<td>0.960000</td>
<td>6.968889</td>
</tr>
<tr>
<th>10</th>
<td>(<span class="caps">ALARM</span> <span class="caps">CLOCK</span> <span class="caps">BAKELIKE</span> <span class="caps">GREEN</span>)</td>
<td>(<span class="caps">ALARM</span> <span class="caps">CLOCK</span> <span class="caps">BAKELIKE</span> <span class="caps">RED</span>)</td>
<td>0.096939</td>
<td>0.815789</td>
<td>8.642959</td>
</tr>
<tr>
<th>11</th>
<td>(<span class="caps">ALARM</span> <span class="caps">CLOCK</span> <span class="caps">BAKELIKE</span> <span class="caps">RED</span>)</td>
<td>(<span class="caps">ALARM</span> <span class="caps">CLOCK</span> <span class="caps">BAKELIKE</span> <span class="caps">GREEN</span>)</td>
<td>0.094388</td>
<td>0.837838</td>
<td>8.642959</td>
</tr>
<tr>
<th>16</th>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">CUPS</span>, <span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span>…</td>
<td>(<span class="caps">SET</span>/20 <span class="caps">RED</span> <span class="caps">RETROSPOT</span> <span class="caps">PAPER</span> <span class="caps">NAPKINS</span>)</td>
<td>0.122449</td>
<td>0.812500</td>
<td>6.125000</td>
</tr>
<tr>
<th>17</th>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">CUPS</span>, <span class="caps">SET</span>/20 <span class="caps">RED</span> <span class="caps">RETRO</span>…</td>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">PLATES</span>)</td>
<td>0.102041</td>
<td>0.975000</td>
<td>7.644000</td>
</tr>
<tr>
<th>18</th>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">PLATES</span>, <span class="caps">SET</span>/20 <span class="caps">RED</span> <span class="caps">RET</span>…</td>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">CUPS</span>)</td>
<td>0.102041</td>
<td>0.975000</td>
<td>7.077778</td>
</tr>
<tr>
<th>22</th>
<td>(<span class="caps">SET</span>/6 <span class="caps">RED</span> <span class="caps">SPOTTY</span> <span class="caps">PAPER</span> <span class="caps">PLATES</span>)</td>
<td>(<span class="caps">SET</span>/20 <span class="caps">RED</span> <span class="caps">RETROSPOT</span> <span class="caps">PAPER</span> <span class="caps">NAPKINS</span>)</td>
<td>0.127551</td>
<td>0.800000</td>
<td>6.030769</td>
</tr>
</tbody>
</table>
</div><p>In looking at the rules, it seems that the green and red alarm clocks are purchased
together and the red paper cups, napkins and plates are purchased together in
a manner that is higher than the overall probability would&nbsp;suggest.</p>
<p>At this point, you may want to look at how much opportunity there is to use the popularity
of one product to drive sales of another. For instance, we can see that we sell
340 Green Alarm clocks but only 316 Red Alarm Clocks so maybe we can drive more
Red Alarm Clock sales through&nbsp;recommendations?</p>
<div class="highlight"><pre><span></span><span class="n">basket</span><span class="p">[</span><span class="s1">'ALARM CLOCK BAKELIKE GREEN'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="mf">340.0</span>

<span class="n">basket</span><span class="p">[</span><span class="s1">'ALARM CLOCK BAKELIKE RED'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="mf">316.0</span>
</pre></div>
<p>What is also interesting is to see how the combinations vary by country of
purchase. Let’s check out what some popular combinations might be in&nbsp;Germany:</p>
<div class="highlight"><pre><span></span><span class="n">basket2</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">'Country'</span><span class="p">]</span> <span class="o">==</span><span class="s2">"Germany"</span><span class="p">]</span>
          <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'InvoiceNo'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">])[</span><span class="s1">'Quantity'</span><span class="p">]</span>
          <span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
          <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'InvoiceNo'</span><span class="p">))</span>

<span class="n">basket_sets2</span> <span class="o">=</span> <span class="n">basket2</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">encode_units</span><span class="p">)</span>
<span class="n">basket_sets2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'POSTAGE'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">frequent_itemsets2</span> <span class="o">=</span> <span class="n">apriori</span><span class="p">(</span><span class="n">basket_sets2</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">rules2</span> <span class="o">=</span> <span class="n">association_rules</span><span class="p">(</span><span class="n">frequent_itemsets2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"lift"</span><span class="p">,</span> <span class="n">min_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rules2</span><span class="p">[</span> <span class="p">(</span><span class="n">rules2</span><span class="p">[</span><span class="s1">'lift'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span>
        <span class="p">(</span><span class="n">rules2</span><span class="p">[</span><span class="s1">'confidence'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)]</span>
</pre></div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table class="table table-condensed" border="1">
<thead>
<tr style="text-align: right;">
<th></th>
<th>antecedants</th>
<th>consequents</th>
<th>support</th>
<th>confidence</th>
<th>lift</th>
</tr>
</thead>
<tbody>
<tr>
<th>7</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">SPACEBOY</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">WOODLAND</span> <span class="caps">ANIMALS</span>)</td>
<td>0.107221</td>
<td>0.571429</td>
<td>4.145125</td>
</tr>
<tr>
<th>9</th>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">CIRCUS</span> <span class="caps">PARADE</span>)</td>
<td>(<span class="caps">PLASTERS</span> <span class="caps">IN</span> <span class="caps">TIN</span> <span class="caps">WOODLAND</span> <span class="caps">ANIMALS</span>)</td>
<td>0.115974</td>
<td>0.584906</td>
<td>4.242887</td>
</tr>
<tr>
<th>10</th>
<td>(<span class="caps">RED</span> <span class="caps">RETROSPOT</span> <span class="caps">CHARLOTTE</span> <span class="caps">BAG</span>)</td>
<td>(<span class="caps">WOODLAND</span> <span class="caps">CHARLOTTE</span> <span class="caps">BAG</span>)</td>
<td>0.070022</td>
<td>0.843750</td>
<td>6.648168</td>
</tr>
</tbody>
</table>
</div><p>It seems that in addition to David Hasselhoff, Germans love Plasters in Tin Spaceboy and
Woodland&nbsp;Animals.</p>
<p>In all seriousness, an analyst that has familiarity with the data would probably
have a dozen different questions that this type of analysis could drive. I did not
replicate this analysis for additional countries or customer combos but the overall
process would be relatively simple given the basic pandas code shown&nbsp;above.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>The really nice aspect of association analysis is that it is easy to run and relatively
easy to interpret. If you did not have access to MLxtend and this association
analysis, it would be exceedingly difficult to find these patterns using
basic Excel analysis. With python and MLxtend, the analysis process is relatively
straightforward and since you are in python, you have access to all the additional
visualization techniques and data analysis tools in the python&nbsp;ecosystem.</p>
<p>Finally, I encourage you to check out the rest of the MLxtend library. If you are
doing any work in sci-kit learn it is helpful to be familiar with MLxtend and how
it could augment some of the existing tools in your data science&nbsp;toolkit.</p>
</div>

  </div>

<ul class="pager">
	 <li class="previous">
		 <a href="https://pbpython.com/prophet-accuracy.html">← How Accurately Can Prophet Project Website&nbsp;Traffic?</a>
	 </li>
	 <li class="next">
		 <a href="https://pbpython.com/pandas-grouper-agg.html">Pandas Grouper and Agg Functions&nbsp;Explained →</a>
	 </li>
</ul> 

<div class="article-tag-list">
<div class="article-tag-list">
<span class="label label-default">Tags</span>
	<a href="https://pbpython.com/tag/pandas.html"><i class="fa fa-tag"></i>pandas</a>&nbsp;
	<a href="https://pbpython.com/tag/mlxtend.html"><i class="fa fa-tag"></i>mlxtend</a>&nbsp;
</div></div>

  <div class="comments">
	<h2>Comments</h2>
	<div id="disqus_thread"><iframe id="dsq-app5075" name="dsq-app5075" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 1px !important; min-width: 100% !important; border: medium none !important; overflow: hidden !important; height: 8414px !important;" src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/a.htm" horizontalscrolling="no" verticalscrolling="no" width="100%" frameborder="0"></iframe></div>
	<script type="text/javascript">
				   (function() {
						var dsq = document.createElement('script');
						dsq.type = 'text/javascript'; dsq.async = true;
						dsq.src = '//pbizpython.disqus.com/embed.js';
						(document.getElementsByTagName('head')[0] ||
						 document.getElementsByTagName('body')[0]).appendChild(dsq);
				  })();
	</script>
  </div>
</article>
        </div><!-- /content -->

        <div class="col-md-3 sidebar-nav" id="sidebar">

<div class="col-xs-6 col-md-12">
  <!-- Begin MailChimp Signup Form -->
  <link href="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/slim-10_7.css" rel="stylesheet" type="text/css">
  <style type="text/css">
    #mc_embed_signup{background: url(/images/cream_dust.png) repeat 0 0; clear:left; font:14px 'Average Sans',sans-serif; }
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
  </style>
  <div id="mc_embed_signup">
  <form action="https://pbpython.us18.list-manage.com/subscribe/post?u=a8d00d9b4326fefe925280de8&amp;id=7e9f14af60" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
      <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to the <a href="https://pbpython.com/pages/mailinglist.html">mailing list</a></label>
    <input type="email" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="">
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_a8d00d9b4326fefe925280de8_7e9f14af60" tabindex="-1"></div>
      <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
      </div>
  </form>
  </div>

  <!--End mc_embed_signup-->


<ul class="list-unstyled social-links">
<li><a href="https://pbpython.com/pages/resources.html">
    <i class="fa fa-smile-o fa-fw fa-lg" aria-hidden="true"></i>Support the site</a></li>
</ul>


<h4><i class="fa fa-comment fa-fw fa-lg"></i> Social</h4>
<ul class="list-unstyled social-links">
    <li><a href="https://github.com/chris1610/pbpython" target="_blank">
	  <i class="fa fa-github fa-fw fa-lg" title="Github"></i>
		Github
	</a></li>
    <li><a href="https://twitter.com/chris1610" target="_blank">
	  <i class="fa fa-twitter fa-fw fa-lg" title="Twitter"></i>
		Twitter
	</a></li>
    <li><a href="http://www.linkedin.com/in/cmoffitt" target="_blank">
	  <i class="fa fa-linkedin fa-fw fa-lg" title="LinkedIn"></i>
		LinkedIn
	</a></li>
</ul>





<h4><i class="fa fa-thumbs-up fa-fw fa-lg"></i>Popular</h4>
<ul class="list-unstyled popular-links">
  <li><a href="https://pbpython.com/pandas-pivot-table-explained.html">
  <i class="fa fa-fw fa-file-text"></i>Pandas Pivot Table Explained</a></li>
  <li><a href="https://pbpython.com/excel-pandas-comp.html">
  <i class="fa fa-fw fa-file-text"></i>Common Excel Tasks Demonstrated in Pandas</a></li>
  <li><a href="https://pbpython.com/visualization-tools-1.html">
  <i class="fa fa-fw fa-file-text"></i>Overview of Python Visualization Tools</a></li>
  <li><a href="https://pbpython.com/web-scraping-mn-budget.html">
  <i class="fa fa-fw fa-file-text"></i>Web Scraping - It's Your Civic Duty</a></li>
  <li><a href="https://pbpython.com/simple-graphing-pandas.html">
  <i class="fa fa-fw fa-file-text"></i>Simple Graphing with IPython and Pandas</a></li>
</ul>


<h4><i class="fa fa-tags fa-fw fa-lg"></i> Tags</h4>
<p class="tag-cloud">
<span class="tag-3">
    <a href="https://pbpython.com/tag/xlsxwriter.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>xlsxwriter
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/ggplot.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>ggplot
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/sets.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>sets
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/s3.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>s3
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/beautifulsoup.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>beautifulsoup
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/plotly.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>plotly
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/word.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>word
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/process.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>process
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/scikit.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>scikit
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/altair.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>altair
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/notebooks.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>notebooks
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/scikit-learn.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>scikit-learn
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/stdlib.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>stdlib
    </a>
</span>
<span class="tag-2">
    <a href="https://pbpython.com/tag/csv.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>csv
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/analyze-this.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>analyze-this
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/notebook.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>notebook
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/github.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>github
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/jinja.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>jinja
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/python.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>python
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/numpy.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>numpy
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/oauth2.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>oauth2
    </a>
</span>
<span class="tag-1">
    <a href="https://pbpython.com/tag/excel.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>excel
    </a>
</span>
<span class="tag-2">
    <a href="https://pbpython.com/tag/ipython.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>ipython
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/google.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>google
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/mlxtend.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>mlxtend
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/vcs.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>vcs
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/xlwings.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>xlwings
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/pdf.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>pdf
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/pygal.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>pygal
    </a>
</span>
<span class="tag-2">
    <a href="https://pbpython.com/tag/matplotlib.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>matplotlib
    </a>
</span>
<span class="tag-1">
    <a href="https://pbpython.com/tag/pandas.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>pandas
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/vega.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>vega
    </a>
</span>
<span class="tag-2">
    <a href="https://pbpython.com/tag/seaborn.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>seaborn
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/outlook.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>outlook
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/barnum.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>barnum
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/cases.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>cases
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/powerpoint.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>powerpoint
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/pelican.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>pelican
    </a>
</span>
<span class="tag-4">
    <a href="https://pbpython.com/tag/matplot.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>matplot
    </a>
</span>
<span class="tag-2">
    <a href="https://pbpython.com/tag/plotting.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>plotting
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/gui.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>gui
    </a>
</span>
<span class="tag-3">
    <a href="https://pbpython.com/tag/bokeh.html">
        <i class="fa fa-tag fa-fw fa-lg"></i>bokeh
    </a>
</span>
</p>

<h4><i class="fa fa-rss fa-fw fa-lg"></i> Feeds</h4>
<ul class="list-unstyled">
    <li><a href="https://pbpython.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">
		<i class="fa fa-rss-square fa-fw fa-lg"></i> Atom Feed</a></li>
</ul>

<hr>
<h4><i class="fa fa-gavel fa-fw" aria-hidden="true"></i> Disclosure</h4>
<p class="tag-3">We are a participant in the Amazon Services LLC Associates Program,
an affiliate advertising program designed to provide a means for us to earn
fees by linking to Amazon.com and affiliated sites.</p>

<hr>
  <script>
    (function() {
      var cx = '006852874439469852271:h7e4xnwk6bc';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gcse, s);
    })();
  </script>
  <div id="___gcse_0"><div class="gsc-control-cse gsc-control-cse-en"><div class="gsc-control-wrapper-cse" dir="ltr"><form class="gsc-search-box gsc-search-box-tools" accept-charset="utf-8"><table class="gsc-search-box" cellspacing="0" cellpadding="0"><tbody><tr><td class="gsc-input"><div class="gsc-input-box" id="gsc-iw-id1"><table style="width: 100%; padding: 0px;" id="gs_id50" class="gstl_50 gsc-input" cellspacing="0" cellpadding="0"><tbody><tr><td id="gs_tti50" class="gsib_a"><input autocomplete="off" type="text" size="10" class="gsc-input" name="search" title="search" style="width: 100%; padding: 0px; border: medium none; margin: 0px; height: auto; background: rgb(255, 255, 255) url(&quot;https://www.google.com/cse/static/images/1x/googlelogo_lightgrey_46x16dp.png&quot;) no-repeat scroll left center; text-indent: 48px; outline: currentcolor none medium;" id="gsc-i-id1" placeholder="Custom Search" dir="ltr" spellcheck="false" x-webkit-grammar="builtin:search" lang="en"></td><td class="gsib_b"><div class="gsst_b" id="gs_st50" dir="ltr"><a class="gsst_a" href="javascript:void(0)" style="display: none;" title="Clear search box" role="button"><span class="gscb_a" id="gs_cb50" aria-hidden="true">×</span></a></div></td></tr></tbody></table></div></td><td class="gsc-search-button"><button class="gsc-search-button gsc-search-button-v2"><svg width="13" height="13" viewBox="0 0 13 13"><title>search</title><path d="m4.8495 7.8226c0.82666 0 1.5262-0.29146 2.0985-0.87438 0.57232-0.58292 0.86378-1.2877 0.87438-2.1144 0.010599-0.82666-0.28086-1.5262-0.87438-2.0985-0.59352-0.57232-1.293-0.86378-2.0985-0.87438-0.8055-0.010599-1.5103 0.28086-2.1144 0.87438-0.60414 0.59352-0.8956 1.293-0.87438 2.0985 0.021197 0.8055 0.31266 1.5103 0.87438 2.1144 0.56172 0.60414 1.2665 0.8956 2.1144 0.87438zm4.4695 0.2115 3.681 3.6819-1.259 1.284-3.6817-3.7 0.0019784-0.69479-0.090043-0.098846c-0.87973 0.76087-1.92 1.1413-3.1207 1.1413-1.3553 0-2.5025-0.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239c0-1.3553 0.4696-2.4966 1.4088-3.4239 0.9392-0.92727 2.0864-1.3969 3.4417-1.4088 1.3553-0.011889 2.4906 0.45771 3.406 1.4088 0.9154 0.95107 1.379 2.0924 1.3909 3.4239 0 1.2126-0.38043 2.2588-1.1413 3.1385l0.098834 0.090049z"></path></svg></button></td><td class="gsc-clear-button"><div class="gsc-clear-button" title="clear results">&nbsp;</div></td></tr></tbody></table></form><div class="gsc-results-wrapper-overlay"><div class="gsc-results-close-btn" tabindex="0"></div><div class="gsc-tabsAreaInvisible"><div class="gsc-tabHeader gsc-inline-block gsc-tabhActive">Custom Search</div><span class="gs-spacer"> </span></div><div class="gsc-tabsAreaInvisible"></div><div class="gsc-above-wrapper-area-invisible"><table class="gsc-above-wrapper-area-container" cellspacing="0" cellpadding="0"><tbody><tr><td class="gsc-result-info-container"><div class="gsc-result-info-invisible"></div></td><td class="gsc-orderby-container"><div class="gsc-orderby-invisible"><div class="gsc-orderby-label gsc-inline-block">Sort by:</div><div class="gsc-option-menu-container gsc-inline-block"><div class="gsc-selected-option-container gsc-inline-block"><div class="gsc-selected-option">Relevance</div><div class="gsc-option-selector"></div></div><div class="gsc-option-menu-invisible"><div class="gsc-option-menu-item gsc-option-menu-item-highlighted"><div class="gsc-option">Relevance</div></div><div class="gsc-option-menu-item"><div class="gsc-option">Date</div></div></div></div></div></td></tr></tbody></table></div><div class="gsc-adBlockInvisible"></div><div class="gsc-wrapper"><div class="gsc-adBlockInvisible"></div><div class="gsc-resultsbox-invisible"><div class="gsc-resultsRoot gsc-tabData gsc-tabdActive"><table class="gsc-resultsHeader" cellspacing="0" cellpadding="0"><tbody><tr><td class="gsc-twiddleRegionCell"><div class="gsc-twiddle"><div class="gsc-title">Web</div></div><div class="gsc-stats"></div><div class="gsc-results-selector gsc-all-results-active"><div class="gsc-result-selector gsc-one-result" title="show one result">&nbsp;</div><div class="gsc-result-selector gsc-more-results" title="show more results">&nbsp;</div><div class="gsc-result-selector gsc-all-results" title="show all results">&nbsp;</div></div></td><td class="gsc-configLabelCell"></td></tr></tbody></table><div><div class="gsc-expansionArea"></div></div></div></div></div></div><div class="gsc-modal-background-image" tabindex="0"></div></div></div></div>

<hr>
<a href="https://www.python.org/psf-landing/">
  <img src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/Supporting-member-badge-colour.png" alt="PSF Supporting Member">
</a>
</div>        </div><!--/sidebar -->
      </div><!--/row-->
    </div><!--/container-->

    <footer id="site-footer">
      <address id="site-colophon">
        <p class="text-center text-muted">
	Ⓒ 2014-2019 Practical Business Python &nbsp;•&nbsp;
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;•&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/" target="_blank">VoidyBootstrap</a> by
        <a href="http://www.robertiwancz.com/" target="_blank">RKI</a>
        </p>
      </address><!-- /colophon  -->
    </footer>

<!-- DISQUS script for displaying comment count -->
<script type="text/javascript">
    var disqus_shortname = 'pbizpython';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- javascript -->
	<script src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/jquery.js"></script>
	<script src="Introduction%20to%20Market%20Basket%20Analysis%20in%C2%A0Python%20-%20Practical%20Business%20Python_files/bootstrap.js"></script>


  
<table style="width: 183px; display: none; top: 1331px; left: 997px; position: absolute;" class="gstl_50 gssb_c" cellspacing="0" cellpadding="0"><tbody><tr><td class="gssb_f"></td><td class="gssb_e" style="width: 100%;"></td></tr></tbody></table><iframe style="display: none;"></iframe></body></html>